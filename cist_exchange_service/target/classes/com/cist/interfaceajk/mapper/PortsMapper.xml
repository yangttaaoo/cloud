<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.cist.interfaceajk.mapper.PortsMapper" >
    
    <select id="listSjgxInterface" resultType="com.cist.interfaceajk.model.SjgxInterfaces">
          select * from SJGX_INTERFACE t
    </select>
  <select id="sjgxInterfacecount" resultType="com.cist.interfaceajk.model.SjgxInterfaces">
  <![CDATA[ 
          select * from (select * from (select  c.create_times,count(*) as coun from (select  t.*, to_char(t.create_time,'yyyy-mm-dd') as create_times from SJGX_INTERFACE t  order by t.create_time)c
group by c.create_times)b  order by b.create_times  desc )g   where rownum  <=7
]]>
    </select>
        <select id="sjgxinterfaceconnect" resultType="com.cist.interfaceajk.model.Sjgxinterfaceconnect">
          select * from SJGX_INTERFACE_CONNECT t
    </select>
    
    <select id="sjgxinterfacez" resultType="int">
          select count(*)
from SJGX_INTERFACE_CONNECT t
where trunc(t.connect_time) = trunc(sysdate-1) and t.connect_status=1  
    </select>
    <select id="sjgxinterfacej" resultType="int">
         select count(*)
from SJGX_INTERFACE_CONNECT t
where trunc(t.connect_time) = trunc(sysdate) and t.connect_status=1
    </select>
    <select id="sjgxinterfacertb" resultType="int">
    select count(*)
from SJGX_INTERFACE_CONNECT t
where to_char(t.connect_time,'yyyy/MM/dd') in (
 SELECT 
    to_char( ADD_MONTHS(sysdate,-12),'yyyy/MM/dd')  as b
FROM dual
) and t.connect_status=1
    </select>
    <select id="sjgxinterfacezong" resultType="int">
     <![CDATA[ 
    select count(*) from SJGX_INTERFACE_CONNECT t  where t.connect_time >=trunc(sysdate,'day')+1 and t.connect_time<=trunc(sysdate,'day')+8
   ]]>
    </select>
       <select id="listSjgxInterfaceweekday" resultType="com.cist.interfaceajk.model.SjgxInterfaces">
        <![CDATA[ 
  select * from ( select c.connect_times,count(*) as coun from ( select t.*,to_char(t.connect_time,'yyyy-MM-dd') as connect_times from SJGX_INTERFACE_CONNECT t  where t.connect_time >=trunc(sysdate,'day')+1 and t.connect_time<=trunc(sysdate,'day')+8
 )c
group by c.connect_times)g
order by g.connect_times
]]>
   </select>
   
       <select id="monthly" resultType="int">
select count(*) from SJGX_INTERFACE_CONNECT t where to_char(sysdate,'yyyy-mm')=to_char(t.connect_time,'yyyy-mm')
    </select>
        <select id="monthlyshang" resultType="int">
select count(*)  from SJGX_INTERFACE_CONNECT t where to_char(t.connect_time,'yyyymm')=to_char(add_months(sysdate,-1),'yyyymm')
    </select>
            <select id="monthlyshangyue" resultType="int">
select count(*)  from SJGX_INTERFACE_CONNECT t where to_char(t.connect_time,'yyyymm')=to_char(add_months(sysdate,-12),'yyyymm')
    </select>
    <select id="numberOfranking" resultType="com.cist.interfaceajk.model.SjgxInterfaces" parameterType="java.util.HashMap" >
 
select * from (  select * from (  select k.interface_name,b.coun from (
  select * from (  select t.interface_id,count(*) as coun from SJGX_INTERFACE_CONNECT t
  <where>
  <if test="starttimepai!=null and starttimepai!=''">
		t.connect_time between to_date(#{starttimepai}, 'yyyy-MM-dd') and to_date(#{endtimepai}, 'yyyy-MM-dd')
		   </if>
</where>
  group by t.interface_id)c
  order by c.coun desc 
  )b
   left join SJGX_INTERFACE k on k.pk_id=b.interface_id)h order by h.coun desc  )v  where 
     <![CDATA[  rownum <=5  ]]>

    </select>
    <select id="numberOfrankingTop" resultType="com.cist.interfaceajk.model.SjgxInterfaces" parameterType="java.util.HashMap">
   
  select * from (
select * from (   select * from (  
select t.interface_id,count(*) as coun from SJGX_INTERFACE_CONNECT t 
<where>
  <if test="starttime!=null and starttime!=''">
		t.connect_time between to_date(#{starttime}, 'yyyy-MM-dd') and to_date(#{endtime}, 'yyyy-MM-dd')
		   </if>
</where>
  group by t.interface_id)c
  order by c.coun desc )p where   <![CDATA[  rownum <=5 ]]>
)x
  left join SJGX_INTERFACE k on k.pk_id=x.interface_id
  
    </select>
    <select id="kingTop" resultType="int" parameterType="java.util.HashMap">
    select  count(*)   from SJGX_INTERFACE_CONNECT b where to_char(b.connect_time,'yyyy-mm-dd')=#{starttimes} and b.interface_id=#{interfaceids}
    </select>
</mapper>