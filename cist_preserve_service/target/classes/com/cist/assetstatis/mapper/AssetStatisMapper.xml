<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.cist.assetstatis.mapper.AssetStatisMapper">
	<select id="devtotal" resultType="com.cist.assetstatis.model.JksbzcInfo">
     	 select t.asset_type,count(*) as asset_tol from JTYW_JKSBZC_PLAN t group by t.asset_type
   	</select>
   	<select id="typeinfo" resultType="com.cist.assetstatis.model.JksbzcInfo" parameterType="java.util.Map">
     	 select t.device_type,count(*) as asset_tol from JTYW_JKSBZC_PLAN t 
     	 <where>
     	 1=1
     	 <if test="zclx !=0">
     	 and t.asset_type = #{zclx}
     	 </if>
     	 </where>
     	 group by t.device_type 
   	</select>
   	<select id="dateinfo" resultType="com.cist.assetstatis.model.JksbzcInfo">
     	 select to_char(DEPLOY_TIME,'mm') as yf,count(ASSET_TYPE) as asset_tol,asset_type from JTYW_JKSBZC_PLAN where to_char(DEPLOY_TIME,'yyyy')=(select  to_char(sysdate, 'yyyy' ) from dual) group by to_char(DEPLOY_TIME,'mm'),ASSET_TYPE order by to_char(DEPLOY_TIME,'mm')
   	</select>
   	<select id="dateinfo1" resultType="com.cist.assetstatis.model.JksbzcInfo">
     	select to_char(DEPLOY_TIME,'yyyy-mm-dd') as rq,count(ASSET_TYPE) as asset_tol,asset_type from JTYW_JKSBZC_PLAN where to_char(DEPLOY_TIME,'yyyy-mm-dd')=(select  to_char(sysdate, 'yyyy-mm-dd' ) from dual) group by to_char(DEPLOY_TIME,'yyyy-mm-dd'),ASSET_TYPE order by to_char(DEPLOY_TIME,'yyyy-mm-dd')
   	</select>
   	<select id="dateinfo2" resultType="com.cist.assetstatis.model.JksbzcInfo">
     	select t.day as rq,c.asset_tol,c.ASSET_TYPE from (SELECT TO_CHAR(SYSDATE - TO_NUMBER(TO_CHAR(SYSDATE, 'D')) + LEVEL+1, 'YYYY-MM-DD') DAY
 		 FROM DUAL
		CONNECT BY LEVEL &lt;= 7) t  LEFT OUTER JOIN (select count(ASSET_TYPE) as asset_tol,to_char(t.DEPLOY_TIME,'yyyy-mm-dd') as yf,ASSET_TYPE from JTYW_JKSBZC_PLAN t 
		where substr(to_char(t.DEPLOY_TIME,'yyyymmdd'),3,6) > to_char( sysdate-(to_char(sysdate,'D')),'yymmdd')
		group by to_char(t.DEPLOY_TIME,'yyyy-mm-dd'),t.asset_type
		order by substr(to_char(t.DEPLOY_TIME,'yyyy-mm-dd'),3,6)) c on t.day = c.yf ORDER BY t.day
   	</select>
   	<select id="dateinfo3" resultType="com.cist.assetstatis.model.JksbzcInfo">
     	select count(ASSET_TYPE) as asset_tol,to_char(DEPLOY_TIME,'dd')as rq,ASSET_TYPE from JTYW_JKSBZC_PLAN where DEPLOY_TIME>=TRUNC(SYSDATE, 'MM') and DEPLOY_TIME  &lt;=last_day(SYSDATE) group by to_char(DEPLOY_TIME,'dd'),asset_type order by to_char(DEPLOY_TIME,'dd')
   	</select>
   	<select id="dateinfo4" resultType="com.cist.assetstatis.model.JksbzcInfo" parameterType="java.util.Map">
   	    select count(ASSET_TYPE) as asset_tol,ASSET_TYPE from JTYW_JKSBZC_PLAN t 
   	    <where>
   	    <if test="kssj!=null and kssj!='' and kssj!='null'">
		    <![CDATA[ and DEPLOY_TIME >=to_date(#{kssj},'yyyy-mm-dd HH24:mi:ss')]]>
	        </if>
	        <if test="jssj!=null and jssj!='' and jssj!='null'">
		    <![CDATA[and DEPLOY_TIME <= to_date(#{jssj},'yyyy-mm-dd HH24:mi:ss') ]]>
	        </if>
   	    </where>
   	    group by t.ASSET_TYPE
    </select>
</mapper>