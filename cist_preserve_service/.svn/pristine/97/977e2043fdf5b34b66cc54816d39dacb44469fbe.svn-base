<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.cist.opsvdt.mapper.OpsDvtMapper">

	<select id="quertAll" resultType="com.cist.opsvdt.model.Jtyw_group">
		<!-- select a.*,b.* from jtyw_maintenance_group_member a   , jtyw_maintenance_group b 
		
		
		   a.fk_group_id=b.fk_comp_id -->
	select a.*,b.fk_group_id,b.group_contacts,b.group_contacts_num
 from  jtyw_maintenance_group a  
inner join jtyw_maintenance_group_member b  on a.pk_id=b.fk_group_id 
	<where>
		<if test="group_name !=null and group_name !='' ">
			and a.group_name=#{group_name}
		
		</if>
		<if test="group_contacts !=null and group_contacts !='' ">
			and b.group_contacts=#{group_contacts}
		
		</if>

		</where>
	</select>
	
	<select id="queryCorp" resultType="com.cist.opsvdt.model.Jtyw_group_member">
		select *  from jtyw_maintenance_group_member
		
	</select>
	
	<select id="queryGroup" resultType="com.cist.opsvdt.model.Jtyw_group">
		select *  from jtyw_maintenance_group
		
	</select>
	<insert id="insertVdt"  parameterType="java.util.Map">
	<selectKey resultType="java.lang.Integer" order="BEFORE" keyProperty="fk_group_id">
        SELECT cistsys.SEQ_FRM_CODE.nextval FROM DUAL
    </selectKey>
		insert into jtyw_maintenance_group 
		(
			pk_id,
			group_name,
			group_describe,
			fk_comp_id
		)
		
		
		values
		(
			#{fk_group_id},
			#{group_name,jdbcType=VARCHAR},
			#{group_describe,jdbcType=VARCHAR},
			#{fk_comp_id,jdbcType=INTEGER}
		)

	</insert>
	
	<insert id="insertVdts"  parameterType="java.util.Map">
		insert into jtyw_maintenance_group_member 
		(
			pk_id,
			fk_group_id,
			group_contacts,
			group_contacts_num,
			is_charger
		)
		
		
		values
		(
		
			
			cistsys.SEQ_FRM_CODE.nextval,
			#{fk_group_id},
			#{group_contacts,jdbcType=VARCHAR},
			#{group_contacts_num},
			#{is_charger,jdbcType=VARCHAR }
				
		)

	</insert>
	
	<delete id="deleteVdt" parameterType="java.util.Map">
		DELETE FROM jtyw_maintenance_group 
		WHERE  pk_id=#{pk_id} 
	</delete>
	
	<delete id="deleteVdts" parameterType="java.util.Map">
		DELETE FROM cistsys.jtyw_maintenance_group_member t
		WHERE  t.fk_group_id=#{fk_group_id} 
	</delete>
	
<delete id="deleteAlls" parameterType="java.util.Map">
begin
delete FROM cistsys.jtyw_maintenance_group 
		WHERE pk_id in
		<foreach item="pk" collection="array" open="(" separator="," close=")">
            #{pk}
        </foreach> 
	
;
 delete FROM cistsys.jtyw_maintenance_group_member 
		WHERE fk_group_id in
		<foreach item="pk" collection="array" open="(" separator="," close=")">
            #{pk}
        </foreach>
;
end;
	</delete>
	
	<update id="updateVdt"  parameterType="java.util.Map">
		update jtyw_maintenance_group 
		<set>
			<if test="group_name != null and group_name !=''">
				group_name = #{group_name},
			</if>
			<if test="group_describe != null and group_describe !=''">
				group_describe = #{group_describe},
			</if>
			<if test="fk_comp_id != null and fk_comp_id !=''">
				fk_comp_id = #{fk_comp_id},
			</if>
		
			
			
		</set>
		where pk_id = #{pk_id,jdbcType=DECIMAL}
	</update>
	
		<update id="updateVdts"  parameterType="java.util.Map">
		update jtyw_maintenance_group_member 
		<set>
			<if test="group_contacts != null and group_contacts !=''">
				group_contacts = #{group_contacts},
			</if>
			<if test="is_charger != null and is_charger !=''">
				is_charger = #{is_charger},
			</if>
			<if test="group_contacts_num != null and group_contacts_num !=''">
				group_contacts_num = #{group_contacts_num},
			</if>
			
			
		</set>
		where fk_group_id = #{fk_group_id,jdbcType=DECIMAL}
	</update>
  
  		<!-- 批量删除 -->
	<delete id="deleteAll" parameterType="java.util.HashMap">
		delete FROM cistsys.sys_stick_mag
		WHERE sk_pk in
		<foreach item="pk" collection="array" open="(" separator=","
			close=")">
			#{pk}
		</foreach>
	</delete>
  	
	
</mapper>