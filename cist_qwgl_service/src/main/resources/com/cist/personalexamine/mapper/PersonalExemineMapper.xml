<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.cist.personalexamine.mapper.PersonalExemineMapper">
   	
   	<select id="ExamineInfopageList" resultType="com.cist.personalentry.model.IndividualInfo" parameterType="java.util.HashMap">
      select t.*,y.sypi_name as fk_user_name,to_char(t.input_time,'yyyy-mm-dd HH24:mi:ss') as input_time_name,to_char(t.start_date,'yyyy-mm-dd HH24:mi:ss') as start_date_name,to_char(t.end_date,'yyyy-mm-dd HH24:mi:ss') as end_date_name,k.dept_name as fk_dept_name from QW_INDIVIDUAL_ASSESSMENT t,SYS_POLICE_INFO y,sys_depart_info k
      <where>
      	t.fk_user_id = y.sypi_pk and t.fk_dept_id = k.dept_code and t.VERIFY_STATUS = 0
      	<if  test="khry!=null and khry!=''">
      	  and sypi_name LIKE '%'||#{khry}||'%'
      	</if>
      	<if  test="ssbm!=null and ssbm!=''">
      	  and fk_dept_id = #{ssbm}
      	</if>
      </where>
       
   	</select>
   	
   	<select id="getTopice" resultType="java.lang.String" parameterType="java.lang.Integer">
     select t.TOPIC_NAME from QW_APPRAISE_TOPIC t 
      <where>
      1=1
      	<if  test="_parameter!=null and _parameter!=''">
      	  and t.pk_id = #{_parameter}
      	</if>
      </where>
   	</select>
   	
   	<select id="getRegulations" resultType="java.lang.String" parameterType="java.lang.Integer">
     select t.REGULATIONS_NAME from QW_APPRAISE_REGULATIONS t 
      <where>
      1=1
      	<if  test="_parameter!=null and _parameter!=''">
      	  and t.pk_id = #{_parameter}
      	</if>
      </where>
   	</select>
   	
   	<update id="examinepersonal"  parameterType="java.util.HashMap">
       UPDATE QW_INDIVIDUAL_ASSESSMENT SET 
             VERIFY_STATUS=#{rev},
             FK_VERIFY_PERSON_ID=#{khryid},
             VERIFY_TIME=sysdate,
             VERIFY_NOT_PASS_REASON=#{redate,jdbcType=VARCHAR}
       where pk_id = #{pk}
     </update>
     
     <select id="getReport" resultType="java.lang.Character" parameterType="java.lang.Integer">
     select t.REPORT_TYPE from QW_REPORT t 
      <where>
      1=1
      	<if  test="_parameter!=null and _parameter!=''">
      	  and t.pk_id = #{_parameter}
      	</if>
      </where>
   	</select>
   	
</mapper>