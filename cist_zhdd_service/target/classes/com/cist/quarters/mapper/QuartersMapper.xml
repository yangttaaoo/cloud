<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.cist.quarters.mapper.QuartersMapper" >
  
  <select id="querylistpageList" resultType="com.cist.quarters.model.Postinfo" parameterType="java.util.HashMap">
   select * from ZHDD_POST_INFO t
       <where>
     		<if test="post_name!=null and post_name!=''">
		   and  t.post_name=#{post_name}
		   </if>
		   <if test="fk_dept_id!=null and fk_dept_id!=''">
		   and  t.fk_dept_id=#{fk_dept_id}
		   </if>
		      <if test="wfkssj != null and wfkssj != '' and wfjssj != null and wfjssj != ''">
		     and t.post_time BETWEEN 
		     to_date(#{wfkssj},'yyyy-mm-dd hh24:mi:ss') and to_date(#{wfjssj},'yyyy-mm-dd hh24:mi:ss')
		   </if>
    </where>
  </select>
  <select id="selectPostglinfo" resultType="com.cist.quarters.model.Postglinfo" parameterType="java.util.HashMap">
  select * from ZHDD_POSTGL_INFO t where t.fk_post_id=#{fk_post_id}
  </select>
   <select id="functiontypeList" resultType="com.cist.quarters.model.Functiontype" >
  select * from ZHDD_FUNCTION_TYPE t
   </select>
	<select id="fssunctionconf" resultType="com.cist.quarters.model.Functionconf" parameterType="java.util.HashMap">
  select * from ZHDD_FUNCTION_CONF t where t.fk_function_type_id=#{fk_function_type_id}
   </select>
     <insert id="addPostinfo" parameterType="com.cist.quarters.model.Postinfo">
     <selectKey resultType="java.lang.Integer" order="BEFORE" keyProperty="pk_id">
			select SEQ_ZHDD_POST_INFO.nextval  as pk_id  from dual
		</selectKey>
   INSERT INTO ZHDD_POST_INFO
    (pk_id, 
    is_default,
     post_name,
     fk_dept_id, 
     remarks,
     post_time
         )
     VALUES
      (
     #{pk_id}, 
    #{is_default},
     #{post_name},
     #{fk_dept_id}, 
     #{remarks},
     #{post_time}
      )
   </insert>
     <insert id="addPostglinfo" parameterType="List">
     
     BEGIN

    <foreach collection="list" item="item" index="index"    separator="">
       INSERT INTO ZHDD_POSTGL_INFO(FK_POST_ID,FK_FUNCTION_CONF_ID)
       values
       (
     #{item.FK_POST_ID,jdbcType=VARCHAR},
     #{item.FK_FUNCTION_CONF_ID,jdbcType=VARCHAR});
       
    </foreach>
COMMIT;  
    END;  
   </insert>
          <select id="depart_infolist" resultType="com.cist.quarters.model.Depart_info" parameterType="java.lang.Integer">
select t.dept_pk,t.dept_code,t.dept_name as name,t.DEPT_SUPERIOR from sys_depart_info t 
<where>
		  <if test="_parameter  == null or _parameter  == ''">
		     t.DEPT_SUPERIOR is null
		   </if>
		     <if test="_parameter  != null and _parameter  != ''">
		     t.DEPT_SUPERIOR=#{_parameter}  
		   </if>
</where>
   </select>
   <delete id="delpostinfo" parameterType="java.util.HashMap">
   delete ZHDD_POST_INFO t where  t.pk_id=#{pk_id}
   </delete>
      <delete id="delpostinfogl" parameterType="java.util.HashMap">
   delete ZHDD_POSTGL_INFO  t where t.fk_post_id=#{pk_id}
   </delete> 
   <update id="updatemo">
   update ZHDD_POST_INFO t set t.is_default=0
   </update>
   <update id="updatePostinfo" parameterType="com.cist.quarters.model.Postinfo">
   update ZHDD_POST_INFO 
t set t.is_default=#{is_default},
t.remarks=#{remarks},
t.fk_dept_id=#{fk_dept_id},
t.post_name=#{post_name},
t.post_time=#{post_time}
where t.pk_id=#{pk_id}
   </update>
</mapper>